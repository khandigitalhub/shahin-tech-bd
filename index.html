<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Shahin Tech BD</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
margin:0;
font-family:Arial, sans-serif;
background:#f2f2f2;
}

/* HEADER */
header{
background:#0b1f3a;
display:flex;
align-items:center;
justify-content:space-between;
padding:12px;
color:white;
position:sticky;
top:0;
z-index:1000;
}

.brand-name{
font-size:20px;
font-weight:bold;
}

.search-box input{
padding:8px;
width:180px;
border:none;
border-radius:20px;
}

.cart-btn{
cursor:pointer;
font-weight:bold;
}

/* BANNER */
.banner{
background:linear-gradient(45deg,#0b1f3a,#1e3c72);
color:white;
text-align:center;
padding:30px 10px;
font-size:22px;
}

/* CATEGORY */
.categories{
display:flex;
overflow:auto;
padding:10px;
background:white;
}

.categories div{
background:#eee;
padding:6px 12px;
margin-right:8px;
border-radius:20px;
cursor:pointer;
white-space:nowrap;
font-size:14px;
}

.categories div:hover{
background:#0b1f3a;
color:white;
}

/* PRODUCTS */
.products{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
gap:12px;
padding:12px;
}

.card{
background:white;
border-radius:12px;
padding:10px;
box-shadow:0 3px 8px rgba(0,0,0,0.1);
transition:0.3s;
}

.card:hover{
transform:translateY(-4px);
}

.card img{
width:100%;
height:140px;
object-fit:cover;
border-radius:8px;
}

.card h4{
margin:8px 0 4px;
font-size:15px;
}

.card p{
margin:0;
font-weight:bold;
}

.card button{
padding:7px;
width:100%;
border:none;
margin-top:6px;
border-radius:6px;
cursor:pointer;
}

.add-btn{
background:#0b1f3a;
color:white;
}

.buy-btn{
background:#ff6a00;
color:white;
}

/* CART */
.hidden{display:none;}

.cart-page{
padding:10px;
}

.cart-item{
background:white;
padding:10px;
margin-bottom:8px;
border-radius:8px;
}

.qty-btn{
padding:4px 8px;
border:none;
background:#0b1f3a;
color:white;
margin-right:4px;
}

.checkout-box{
background:white;
padding:10px;
margin-top:10px;
border-radius:8px;
}

input,select{
padding:8px;
width:100%;
margin-bottom:8px;
}

/* SUCCESS */
.success{
position:fixed;
top:40%;
left:50%;
transform:translate(-50%,-50%);
background:white;
padding:20px;
border-radius:8px;
display:none;
box-shadow:0 0 10px rgba(0,0,0,0.3);
}
</style>
</head>

<body>

<header>
<div class="brand-name">Shahin Tech BD</div>

<div class="search-box">
<input type="text" id="search" placeholder="Search products...">
</div>

<div class="cart-btn" onclick="showCart()">
üõí (<span id="cartCount">0</span>)
</div>
</header>

<div class="banner">
Welcome to Shahin Tech BD ‚Äì Trusted Online Shop
</div>

<div class="categories" id="categories"></div>
<div class="products" id="productList"></div>
<div class="cart-page hidden" id="cartPage"></div>

<div class="success" id="successBox">
<h3>üéâ Order Confirmed!</h3>
<p>‡¶ß‡¶®‡ßç‡¶Ø‡¶¨‡¶æ‡¶¶ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§</p>
<button onclick="closeSuccess()">OK</button>
</div>

<script>

const scriptURL="https://script.google.com/macros/s/AKfycbxsJm5bOqhSJSbT-mrhlCV4lBAhNvWuL5HiejIYH7GrqUo-M4wg7DXm29ePapMot2iq/exec";

let products=[];
let cart=[];

fetch(scriptURL)
.then(res=>res.json())
.then(data=>{
products=data;
loadCategories();
displayProducts(products);
});

function normalize(obj){
let newObj={};
for(let key in obj){
newObj[key.toLowerCase()]=obj[key];
}
return newObj;
}

function loadCategories(){
let cats=[...new Set(products.map(p=>normalize(p).category))];
let html='<div onclick="displayProducts(products)">All</div>';
cats.forEach(c=>{
html+=`<div onclick="filterCategory('${c}')">${c}</div>`;
});
document.getElementById("categories").innerHTML=html;
}

function filterCategory(cat){
let filtered=products.filter(p=>normalize(p).category==cat);
displayProducts(filtered);
}

function displayProducts(list){
let html="";
list.forEach(p=>{
let pr=normalize(p);
html+=`
<div class="card">
<img src="${pr.image}">
<h4>${pr.name}</h4>
<p>‡ß≥${pr.price}</p>

<button class="add-btn"
onclick="addToCart('${pr.id}','${pr.name}',${pr.price},'${pr.image}')">
Add to Cart
</button>

<button class="buy-btn"
onclick="buyNow('${pr.id}','${pr.name}',${pr.price},'${pr.image}')">
Buy Now
</button>
</div>`;
});
document.getElementById("productList").innerHTML=html;
}

function addToCart(id,name,price,image){
let found=cart.find(item=>item.id==id);
if(found){found.qty++}
else{cart.push({id,name,price,image,qty:1})}
updateCartCount();
}

function buyNow(id,name,price,image){
cart=[];
cart.push({id,name,price,image,qty:1});
updateCartCount();
showCart();
}

function updateCartCount(){
document.getElementById("cartCount").innerText=
cart.reduce((a,b)=>a+b.qty,0);
}

function showCart(){
document.getElementById("cartPage").classList.remove("hidden");

let html="";
let subtotal=0;

cart.forEach(item=>{
subtotal+=item.price*item.qty;
html+=`
<div class="cart-item">
<img src="${item.image}" width="60">
<b>${item.name}</b>
<p>‡ß≥${item.price} x ${item.qty}</p>
<button class="qty-btn" onclick="changeQty('${item.id}',-1)">-</button>
<button class="qty-btn" onclick="changeQty('${item.id}',1)">+</button>
</div>`;
});

html+=`
<div class="checkout-box">
<p>Subtotal: ‡ß≥${subtotal}</p>

<select id="area" onchange="updateTotal(${subtotal})">
<option value="50">‡¶ú‡¶≤‡¶¢‡¶æ‡¶ï‡¶æ (50)</option>
<option value="75">‡¶®‡ßÄ‡¶≤‡¶´‡¶æ‡¶Æ‡¶æ‡¶∞‡ßÄ (75)</option>
<option value="120">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ (120)</option>
</select>

<p>Total: ‡ß≥<span id="finalTotal">${subtotal+50}</span></p>

<input id="customername" placeholder="Your Name">
<input id="phone" placeholder="Phone">
<input id="address" placeholder="Address">

<button onclick="placeOrder(${subtotal})">Confirm Order</button>
</div>`;

document.getElementById("cartPage").innerHTML=html;
}

function changeQty(id,change){
let item=cart.find(i=>i.id==id);
item.qty+=change;
if(item.qty<=0){cart=cart.filter(i=>i.id!=id)}
showCart();
updateCartCount();
}

function updateTotal(subtotal){
let delivery=parseInt(document.getElementById("area").value);
document.getElementById("finalTotal").innerText=subtotal+delivery;
}

function placeOrder(subtotal){
let delivery=parseInt(document.getElementById("area").value);
let total=subtotal+delivery;

let productlist=cart.map(i=>`${i.name} (${i.qty}pcs)`).join(", ");

let formData=new FormData();
formData.append("customername",document.getElementById("customername").value);
formData.append("phone",document.getElementById("phone").value);
formData.append("address",document.getElementById("address").value);
formData.append("productlist",productlist);
formData.append("subtotal",subtotal);
formData.append("delivery",delivery);
formData.append("total",total);

fetch(scriptURL,{method:"POST",body:formData})
.then(res=>res.text())
.then(()=>{
cart=[];
updateCartCount();
document.getElementById("cartPage").classList.add("hidden");
document.getElementById("successBox").style.display="block";
});
}

function closeSuccess(){
document.getElementById("successBox").style.display="none";
}

document.getElementById("search").addEventListener("input",function(){
let value=this.value.toLowerCase();
let filtered=products.filter(p=>normalize(p).name.toLowerCase().includes(value));
displayProducts(filtered);
});

</script>

</body>
</html>
