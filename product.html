<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product - Shahin Tech BD</title>

<style>
body{
margin:0;
font-family:Arial;
background:#f4f4f4;
padding-bottom:280px;
}

/* PRODUCT AREA */
.product-box{
background:white;
padding:15px;
}

.product-box img{
width:100%;
height:220px;
object-fit:cover;
border-radius:10px;
}

.product-box h2{
margin:10px 0 5px;
}

.price{
color:#ff512f;
font-size:20px;
font-weight:bold;
}

.old{
text-decoration:line-through;
color:gray;
font-size:14px;
}

/* ORDER BOX */
.order-box{
position:fixed;
bottom:0;
left:0;
right:0;
background:white;
padding:15px;
box-shadow:0 -3px 10px rgba(0,0,0,0.2);
border-top-left-radius:15px;
border-top-right-radius:15px;
}

/* QTY */
.qty{
display:flex;
justify-content:center;
align-items:center;
gap:10px;
margin:10px 0;
}

.qty button{
padding:5px 12px;
font-size:18px;
border:none;
background:#ff512f;
color:white;
border-radius:5px;
}

.qty span{
font-size:18px;
font-weight:bold;
}

/* INPUT */
input, select{
width:100%;
padding:8px;
margin:5px 0;
border-radius:6px;
border:1px solid #ccc;
}

.total{
background:#fff3e0;
padding:8px;
border-radius:6px;
margin-top:5px;
font-size:14px;
}

.order-btn{
width:100%;
padding:10px;
margin-top:8px;
background:#ff512f;
color:white;
border:none;
border-radius:6px;
font-size:15px;
}
</style>
</head>

<body>

<div class="product-box" id="productDetails"></div>

<div class="order-box">
<div class="qty">
<button onclick="decrease()">-</button>
<span id="quantity">1</span>
<button onclick="increase()">+</button>
</div>

<select id="delivery" onchange="updateTotal()">
<option value="50">Jaldhaka - ৳50</option>
<option value="100">Outside District - ৳100</option>
</select>

<div class="total" id="totalBox"></div>

<button class="order-btn" onclick="placeOrder()">Place Order</button>
</div>

<script>
const SHEET_URL="https://opensheet.elk.sh/1wrf-8XMPQ1xTcGUqQ20QxZI6dWvO-Osnp0Nd0FWS1wQ/Products";
const ORDER_SCRIPT_URL="PASTE_YOUR_GOOGLE_SCRIPT_URL_HERE";

let productData;
let quantity=1;
let deliveryCharge=50;

const params=new URLSearchParams(window.location.search);
const productId=params.get("id");

fetch(SHEET_URL)
.then(res=>res.json())
.then(data=>{
productData=data.find(p=>p.id==productId);
showProduct();
updateTotal();
});

function showProduct(){
document.getElementById("productDetails").innerHTML=`
<img src="${productData.image}" onerror="this.src='https://via.placeholder.com/300x200'">
<h2>${productData.name}</h2>
<div class="old">৳${productData.oldprice}</div>
<div class="price">৳${productData.price}</div>
<p>${productData.description}</p>
`;
}

function increase(){
quantity++;
document.getElementById("quantity").innerText=quantity;
updateTotal();
}

function decrease(){
if(quantity>1){
quantity--;
document.getElementById("quantity").innerText=quantity;
updateTotal();
}
}

function updateTotal(){
deliveryCharge=parseInt(document.getElementById("delivery").value);
let total=(productData.price*quantity)+deliveryCharge;

document.getElementById("totalBox").innerHTML=
`Product: ৳${productData.price*quantity}<br>
Delivery: ৳${deliveryCharge}<br>
<b>Grand Total: ৳${total}</b>`;
}

function placeOrder(){

let user=JSON.parse(localStorage.getItem("userData"));

if(!user){
alert("দয়া করে আগে Account এ তথ্য সেভ করুন");
window.location.href="account.html";
return;
}

let orderData={
product:productData.name,
price:productData.price,
quantity:quantity,
delivery:deliveryCharge,
total:(productData.price*quantity)+deliveryCharge,
customer:user.name,
phone:user.phone,
address:user.address+", "+user.upazila+", "+user.district
};

fetch(ORDER_SCRIPT_URL,{
method:"POST",
body:JSON.stringify(orderData)
})
.then(res=>res.text())
.then(data=>{
alert("Order সফল হয়েছে ✅");
window.location.href="index.html";
});
}
</script>

</body>
</html>
