<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Details</title>

<style>
body{margin:0;font-family:Arial;background:#f5f5f5;}
.header{background:#0f2a56;color:white;padding:15px;font-size:18px;}
.container{padding:15px;}
.card{background:white;padding:15px;border-radius:10px;
box-shadow:0 4px 12px rgba(0,0,0,0.1);margin-bottom:15px;}
img{width:100%;border-radius:10px;}
.old{color:gray;text-decoration:line-through;}
.new{color:#ff6a00;font-size:22px;font-weight:bold;}
.badge{background:red;color:white;padding:4px 8px;
border-radius:6px;font-size:12px;display:inline-block;margin-top:5px;}
button{width:100%;padding:12px;margin-top:10px;
border:none;border-radius:8px;font-weight:bold;font-size:16px;}
.buy{background:#ff6a00;color:white;}
input{width:100%;padding:10px;margin-top:8px;border-radius:6px;border:1px solid #ccc;}
.hidden{display:none;}
</style>
</head>

<body>

<div class="header">Shahin Tech BD</div>

<div class="container">
<div class="card" id="productBox"></div>

<div class="card hidden" id="orderBox">
<h3>Order Now</h3>
<input id="name" placeholder="Your Name">
<input id="phone" placeholder="Phone Number">
<input id="address" placeholder="Address">
<button class="buy" onclick="submitOrder()">Confirm Order</button>
</div>
</div>

<script>

const SHEET_URL = "https://opensheet.elk.sh/1wrf-8XMPQ1xTcGUqQ20QxZI6dWvO-Osnp0Nd0FWS1wQ/Products";
const ORDER_URL = "https://script.google.com/macros/s/AKfycbwmSjQZKHkql6DmE9pNxO4VmqwnCeDSqrru29ENN-RLUFpAUVjhapHgQei63mt7Gz6H/exec";

let product;

const params = new URLSearchParams(window.location.search);
const id = params.get("id");

fetch(SHEET_URL)
.then(res=>res.json())
.then(data=>{
    product = data.find(p => p.id == id);
    showProduct();
});

function showProduct(){
    document.getElementById("productBox").innerHTML = `
        <img src="${product.image}">
        <h2>${product.name}</h2>
        <div class="old">৳${product.oldprice}</div>
        <div class="new">৳${product.price}</div>
        <div class="badge">${product.discount}% OFF</div>
        <p>${product.description}</p>
        <button class="buy" onclick="buyNow()">Buy Now</button>
    `;
}

function buyNow(){
    document.getElementById("orderBox").classList.remove("hidden");
}

function submitOrder(){

    const name = document.getElementById("name").value;
    const phone = document.getElementById("phone").value;
    const address = document.getElementById("address").value;

    if(!name || !phone || !address){
        alert("Fill all fields");
        return;
    }

    const orderData = {
        customername: name,
        phone: phone,
        address: address,
        paymentmethod: "Cash On Delivery",
        productlist: product.name + " - ৳" + product.price
    };

    fetch(ORDER_URL,{
        method:"POST",
        body: JSON.stringify(orderData)
    })
    .then(res=>res.text())
    .then(data=>{
        alert("Order Successful!");
        document.getElementById("orderBox").classList.add("hidden");
    })
    .catch(err=>{
        alert("Order Failed");
    });
}

</script>

</body>
</html>
